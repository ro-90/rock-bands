<%- include('../partial/head',{title:"Profile"}) %>

<body>
  <%- include('../partial/header') %>
  <main>
    <form action="/users/profile/<%=user.id%>?_method=PUT" method="post" enctype="multipart/form-data">

      <label for="name">Nombre</label>

      <input type="text" name="nombre" id="name" min="6" max="50" value="<%= locals.user && locals.user.nombre ? user.nombre : "" %>">
      <% if(locals.errores && locals.errores.nombre) {%>
      <p><%= errores.nombre.msg %></p>
      <% } %>

      <label for="email">Email</label>
      <input type="email" name="correo" id="email" required value="<%= locals.user && locals.user.correo ? user.correo : ""%>">

      <% if(locals.errores && locals.errores.correo) {%>
      <p><%= errores.correo.msg %></p>
      <% } %>

      <label for="password">Contraseña</label>
      <input type="password" name="contrasena" id="password" value="">

      <% if(locals.errores && locals.errores.contrasena) {%>
      <p><%= errores.contrasena.msg %></p>
      <% } %>

      <label for="password">Confirmar contraseña</label>
      <input type="password" name="contrasena2" id="password" value="">

      <% if(locals.errores && locals.errores.avatar) {%>
      <p><%= errores.avatar.msg %></p>
      <% } %>


      <label for="dni">Ingrese numero de documento DNI</label>
      <input type="number" name="dni" id="dni" value="<%= locals.user && locals.user.dni ? user.dni : ""%>">

      <% if(locals.errores && locals.errores.dni) {%>
      <p><%= errores.dni.msg %></p>
      <% } %>

      <h2>Dirección</h2>

      <label for="provincia">Provincia</label>
      <select name="provincia" id="provincia">
        <% provincias.forEach(provincia => { %>            
        <option value="<%= provincia.id %>" <%= locals.user && locals.user.provincia && locals.user.provincia == provincia.id ? "selected" : "" %>><%= provincia.nombre%></option>
        <% }); %>
      </select>

      <% if(locals.errores && locals.errores.provincia) {%>
      <p><%= errores.provincia.msg %></p>
      <% } %>

      <label for="localidad">localidad</label>
      <select name="localidad" id="localidad">
        <% localidades.forEach(localidad => { %>
            <option value="<%= localidad.id %>" <%= locals.user && locals.user.localidad && locals.user.localidad == localidad.id ? "selected" : "" %>><%= localidad.nombre%></option>
            <% }); %>
      </select>

      <% if(locals.errores && locals.errores.localidad) {%>
      <p><%= errores.localidad.msg %></p>
      <% } %>

      <label for="calle">Calle</label>
      <input type="text" name="calle" id="calle" value="<%= locals.user && locals.user.calle ? user.calle : ""%>">

      <% if(locals.errores && locals.errores.calle) {%>
      <p><%= errores.calle.msg %></p>
      <% } %>

      <label for="altura">Altura</label>
      <input type="text" name="altura" id="altura" value="<%= locals.user && locals.user.altura ? user.altura : ""%>">

      <% if(locals.errores && locals.errores.altura) {%>
      <p><%= errores.altura.msg %></p>
      <% } %>

      <label for="telefono">telefono</label>
      <input type="number" name="telefono" id="telefono" value="<%= locals.user && locals.user.telefono ? user.telefono : ""%>">

      <% if(locals.errores && locals.errores.telefono) {%>
      <p><%= errores.telefono.msg %></p>
      <% } %>

      <input type="file" name="avatar" id="avatar" accept=".jpg,.png " value="<%= locals.user && locals.user.avatar ? user.avatar : ""%>">

      <button type="submit">Actualizar</button>
    </form>

    <form action="/users/profile/<%=user.id%>?_method=DELETE" method="post">
      <button type="submit" onclick="">Eliminar cuenta</button>
    </form>
  </main>
  <footer>
  </footer>
  <script src="/js/profile.js"></script>
</body>